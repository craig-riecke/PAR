package edu.ithaca.dragon.par.io;

import edu.ithaca.dragon.par.domainModel.Question;
import edu.ithaca.dragon.par.domainModel.QuestionPool;
import edu.ithaca.dragon.par.domainModel.equineUltrasound.EquineQuestionTypes;
import edu.ithaca.dragon.par.pedagogicalModel.LevelTaskGenerator;
import edu.ithaca.dragon.par.pedagogicalModel.TaskGenerator;
import edu.ithaca.dragon.par.studentModel.StudentModel;
import edu.ithaca.dragon.util.JsonUtil;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.List;

import static junit.framework.TestCase.assertEquals;
import static junit.framework.TestCase.assertTrue;

public class ImageTaskTest {

    @Test
    public void toJsonAndBackTest() throws IOException {
        QuestionPool myQP = new QuestionPool(new JsonQuestionPoolDatastore("src/test/resources/author/SampleQuestionPool.json").getAllQuestions());
        List<Question> myQPList = myQP.getAllQuestions();
        ImageTask testImageTask = new ImageTask("../static/images/equine02.jpg\"", myQPList, "None");

        //write to JSON
        JsonUtil.toJsonFile("src/test/resources/autoGenerated/ImageTaskTest-toJsonAndBackTest.json", testImageTask);
        //read from JSON
        ImageTask testImageTaskIn = JsonUtil.fromJsonFile("src/test/resources/autoGenerated/ImageTaskTest-toJsonAndBackTest.json",ImageTask.class);
        //compare
        assertTrue(testImageTask.equals(testImageTaskIn));

        Path path = Paths.get("src/test/resources/autoGenerated/ImageTaskTest-toJsonAndBackTest.json");
        Assertions.assertTrue(Files.deleteIfExists(path));

    }

    @Test
    public void changeMessageTest() throws IOException{
        QuestionPool myQP = new QuestionPool(new JsonQuestionPoolDatastore("src/test/resources/author/SampleQuestionPool.json").getAllQuestions());
        List<Question> myQPList = myQP.getAllQuestions();
        ImageTask testImageTask = new ImageTask("../static/images/equine02.jpg\"", myQPList, "None");

        assertEquals("None", testImageTask.getMessage());

        //change message
        testImageTask.changeMessage("You have mastered the material! Feel free to keep practicing");
        assertEquals("You have mastered the material! Feel free to keep practicing", testImageTask.getMessage());

        //change to the same thing
        testImageTask.changeMessage("You have mastered the material! Feel free to keep practicing");
        assertEquals("You have mastered the material! Feel free to keep practicing", testImageTask.getMessage());


        //change to the something different
        testImageTask.changeMessage("asdfghjkl");
        assertEquals("asdfghjkl", testImageTask.getMessage());

        //change back to original
        testImageTask.changeMessage("None");
        assertEquals("None", testImageTask.getMessage());

    }
}
